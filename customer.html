<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>R.Good Service ‚Äî ‡∏û‡∏≠‡∏£‡πå‡∏ó‡∏±‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (Client Read-only)</title>
<meta content="‡∏®‡∏π‡∏ô‡∏¢‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå ‚Äî ‡πÇ‡∏ó‡∏ô‡∏°‡∏∑‡∏î" name="description"/>
<style>
  :root {
    --bg: #0f172a;
    --card: rgba(30, 41, 59, 0.8);
    --card-hover: rgba(51, 65, 85, 0.9);
    --text: #f1f5f9;
    --text-muted: #94a3b8;
    --border: rgba(148, 163, 184, 0.2);
    --accent: #3b82f6;
    --accent-hover: #2563eb;
    --success: #10b981;
    --warning: #f59e0b;
    --danger: #ef4444;
    --radius: 16px;
    --shadow: rgba(0, 0, 0, 0.3);
    --glass-border: rgba(255, 255, 255, 0.1);
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: "Inter", ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
    background:
      radial-gradient(circle at 20% 50%, rgba(59, 130, 246, 0.15), transparent 50%),
      radial-gradient(circle at 80% 20%, rgba(168, 85, 247, 0.1), transparent 50%),
      linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
    color: var(--text);
    min-height: 100vh;
    line-height: 1.6;
  }
  .container { max-width: 1200px; margin: 0 auto; padding: 24px; }
  header {
    display: flex; align-items: center; gap: 16px; margin-bottom: 24px; padding: 20px;
    background: var(--card); border: 1px solid var(--glass-border); border-radius: 20px; backdrop-filter: blur(16px);
    box-shadow: 0 8px 32px var(--shadow);
  }
  .logo {
    width: 48px; height: 48px; border-radius: 12px;
    background: linear-gradient(135deg, var(--accent) 0%, #8b5cf6 100%);
    display: flex; align-items: center; justify-content: center; font-weight: 800; font-size: 18px; color: white;
    box-shadow: 0 4px 16px rgba(59, 130, 246, 0.3);
  }
  .header-content h1 {
    font-size: 22px; font-weight: 600;
    background: linear-gradient(135deg, var(--text) 0%, var(--accent) 100%);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
  }
  .header-status { display: flex; align-items: center; gap: 8px; margin-top: 4px; color: var(--text-muted); font-size: 14px; }
  .status-dot { width: 6px; height: 6px; border-radius: 50%; background: var(--success); animation: pulse 2s infinite; }
  @keyframes pulse { 0%,100%{opacity:1;} 50%{opacity:.5;} }
  .header-actions { margin-left: auto; display: flex; gap: 12px; align-items: center; flex-wrap: wrap; }
  .last-update { color: var(--text-muted); font-size: 13px; }
  .btn {
    display: inline-flex; align-items: center; gap: 8px; padding: 10px 16px; border: 1px solid var(--border);
    border-radius: 12px; background: var(--card); color: var(--text); font-weight: 500; cursor: pointer;
    transition: all .2s ease; text-decoration: none; backdrop-filter: blur(8px); box-shadow: 0 4px 16px rgba(0,0,0,.2); font-size: 14px;
  }
  .btn:hover { background: var(--card-hover); border-color: var(--accent); transform: translateY(-1px); box-shadow: 0 6px 20px rgba(59,130,246,.3); }
  .btn.primary { background: linear-gradient(135deg, var(--accent) 0%, #8b5cf6 100%); border-color: transparent; color: white; font-weight: 600; }
  .btn.primary:hover { background: linear-gradient(135deg, var(--accent-hover) 0%, #7c3aed 100%); transform: translateY(-1px); box-shadow: 0 8px 24px rgba(59,130,246,.4); }
  .btn.ghost { background: transparent; border-color: var(--border); box-shadow: none; }
  .btn.ghost:hover { background: var(--card); }
  .btn.tiny { padding: 6px 10px; font-size: 12px; border-radius: 10px; }
  .card { background: var(--card); border: 1px solid var(--glass-border); border-radius: var(--radius); padding: 20px; backdrop-filter: blur(16px); box-shadow: 0 8px 32px var(--shadow); transition: all .2s ease; }
  .card:hover { background: var(--card-hover); box-shadow: 0 12px 40px var(--shadow); }
  .tabs, nav.tabs { display: flex; gap: 8px; flex-wrap: wrap; margin-bottom: 24px; }
  .tab, .tabs a { padding: 12px 20px; border-radius: 50px; border: 1px solid var(--border); background: transparent; color: var(--text-muted); cursor: pointer; transition: all .2s ease; font-weight: 500; font-size: 14px; text-decoration: none; }
  .tab.active, .tabs a.active { background: linear-gradient(135deg, var(--accent) 0%, #8b5cf6 100%); border-color: transparent; color: white; box-shadow: 0 4px 16px rgba(59,130,246,.3); }
  .tab:hover:not(.active), .tabs a:hover:not(.active) { background: var(--card); border-color: var(--accent); }
  .hidden { display: none !important; }
  .case-overview { display: grid; grid-template-columns: 1fr 300px; gap: 20px; margin-bottom: 20px; }
  @media (max-width: 768px) { .case-overview { grid-template-columns: 1fr; } }
  .main-case-info { background: var(--card); border: 1px solid var(--glass-border); border-radius: var(--radius); padding: 24px; backdrop-filter: blur(16px); box-shadow: 0 8px 32px var(--shadow); }
  .case-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
  .case-title { font-size: 18px; font-weight: 600; color: var(--text); }
  .case-pills { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 16px; }
  .case-pill { background: rgba(59,130,246,0.1); border: 1px solid rgba(59,130,246,0.2); border-radius: 50px; padding: 6px 12px; font-size: 13px; color: var(--accent); font-weight: 500; }
  .product-info { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin: 12px 0 8px; }
  .info-tile { border: 1px solid var(--border); border-radius: 12px; padding: 12px 14px; background: rgba(148,163,184,0.06); backdrop-filter: blur(6px); }
  .info-label { display: block; font-size: 12px; letter-spacing: .3px; color: var(--text-muted); margin-bottom: 4px; text-transform: uppercase; }
  .info-value { font-weight: 600; color: var(--text); word-break: break-word; }
  @media (max-width: 768px) { .product-info { grid-template-columns: 1fr; } }
  .progress-container { margin: 20px 0; }
  .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; gap: 8px; }
  .progress-group { display: flex; align-items: center; gap: 8px; }
  .progress-label { font-weight: 500; color: var(--text); }
  .progress-percentage { font-weight: 700; font-size: 16px; color: var(--accent); }
  .progress-bar { height: 12px; background: rgba(148,163,184,0.1); border: 1px solid var(--border); border-radius: 50px; overflow: hidden; position: relative; }
  .progress-fill { height: 100%; background: linear-gradient(90deg, var(--accent) 0%, #10b981 100%); border-radius: 50px; transition: width .6s ease; position: relative; }
  .progress-fill::after { content: ""; position: absolute; inset: 0; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent); animation: shimmer 2s infinite; }
  @keyframes shimmer { 0%{transform:translateX(-100%);} 100%{transform:translateX(100%);} }
  .stepper-container { margin: 24px 0; }
  .stepper { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; }
  .step { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 16px 8px; text-align: center; transition: all .3s ease; backdrop-filter: blur(8px); }
  .step.completed { background: rgba(16,185,129,0.1); border-color: rgba(16,185,129,0.3); }
  .step.active { background: rgba(59,130,246,0.1); border-color: rgba(59,130,246,0.3); box-shadow: 0 0 20px rgba(59,130,246,0.2); }
  .step-dot { width: 8px; height: 8px; border-radius: 50%; background: var(--text-muted); margin: 0 auto 8px; transition: all .3s ease; }
  .step.completed .step-dot { background: var(--success); }
  .step.active .step-dot { background: var(--accent); animation: pulse-dot 2s infinite; }
  @keyframes pulse-dot { 0%,100%{transform:scale(1);} 50%{transform:scale(1.2);} }
  .step-label { font-size: 11px; font-weight: 600; margin-bottom: 4px; color: var(--text); line-height: 1.3; }
  .step.completed .step-label { color: var(--success); }
  .step.active .step-label { color: var(--accent); }
  .step-date { font-size: 9px; color: var(--text-muted); line-height: 1.2; }
  .section-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; }
  .section-title { font-size: 18px; font-weight: 600; }
  .table-container table { width:100%; border-collapse: collapse; }
  .table-container th, .table-container td { padding:12px; border-bottom: 1px solid var(--border); text-align:left; }
  .status-badge { padding: 4px 10px; border-radius: 999px; border: 1px solid var(--border); font-size: 12px; }
  .status-badge.success { color: var(--success); border-color: rgba(16,185,129,.4); background: rgba(16,185,129,.08); }
  .status-badge.pending { color: var(--warning); border-color: rgba(245,158,11,.4); background: rgba(245,158,11,.08); }
  .chat-container { border: 1px solid var(--glass-border); border-radius: 16px; overflow:hidden; }
  .chat-messages { max-height: 60vh; overflow:auto; padding: 16px; display:flex; flex-direction:column; gap:12px; background: rgba(148,163,184,.06); }
  .chat-message { display:flex; gap:8px; }
  .chat-message.own { justify-content: flex-end; }
  .chat-bubble { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 10px 12px; max-width: 70ch; }
  .chat-time { color: var(--text-muted); font-size: 12px; margin-top: 6px; }
  .chat-input-area { display:flex; gap:8px; padding: 10px; background: var(--card); border-top: 1px solid var(--glass-border); }
  .chat-input { width: 100%; resize: none; padding: 10px 12px; border-radius: 12px; border: 1px solid var(--border); background: rgba(148,163,184,.06); color: var(--text); }
  dialog { border: 1px solid var(--glass-border); border-radius: 16px; padding: 0; background: var(--card); color: var(--text); width: min(600px, 92vw); }
  .modal-header { display:flex; justify-content: space-between; align-items:center; padding: 16px; border-bottom: 1px solid var(--glass-border); }
  .modal-title { font-weight: 600; }
  .modal-content { padding: 16px; }
  .form-group { margin-bottom: 12px; }
  .form-label { display:block; margin-bottom:6px; color: var(--text-muted); font-size: 14px; }
  .form-input, .form-select, textarea.form-input { width:100%; padding: 10px 12px; border-radius: 12px; border: 1px solid var(--border); background: rgba(148,163,184,.06); color: var(--text); }
  .modal-actions { display:flex; gap: 8px; justify-content:flex-end; padding: 12px 16px; border-top: 1px solid var(--glass-border); }
  #notificationContainer { position: fixed; right: 16px; bottom: 16px; display:flex; flex-direction:column; gap: 8px; z-index: 999; }
  .notification { opacity: 0; transform: translateY(6px); transition: all .3s ease; padding: 10px 12px; border-radius: 12px; background: var(--card); border: 1px solid var(--border); }
  .notification.show { opacity: 1; transform: translateY(0); }
  .sr-only { position: absolute; left: -9999px; }
</style>

<script>
/* ====== ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (‡∏Ñ‡∏á‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡∏π‡πÑ‡∏ß‡πâ) ====== */
const STORAGE_KEY = "rgood_case_data_v2";
const DEFAULT_DATA = {
  id: "case_2025_0002",
  publicToken: "pk_XY9zL1m2",
  caseNo: "RG-AG-0002/2025",
  title: "‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≤‡∏£‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏ß‡∏±‡∏ä‡∏û‡∏∑‡∏ä",
  status: "‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠",
  progressPct: 50,
  dueDate: "2025-11-15",
  product: { tradeName: "RG-Herbex 48SL", commonName: "Glyphosate isopropylamine" },
  steps: [
    { key: "receive", label: "‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á", state: "completed", date: "2025-09-05" },
    { key: "precheck", label: "‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô", state: "completed", date: "2025-09-06" },
    { key: "request_more", label: "‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°", state: "completed", date: "2025-09-08" },
    { key: "submit", label: "‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠", state: "active", date: "‚Äî" },
    { key: "waiting_gov", label: "‡∏£‡∏≠‡∏ú‡∏•‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ê", state: "pending", date: "‚Äî" },
    { key: "approved", label: "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß", state: "pending", date: "‚Äî" },
    { key: "close", label: "‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏™", state: "pending", date: "‚Äî" }
  ],
  timeline: [
    { timestamp: "2025-09-08 12:24", text: "‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏°‡∏≠‡∏ö‡∏≠‡∏≥‡∏ô‡∏≤‡∏à", type: "user" },
    { timestamp: "2025-09-06 15:11", text: "‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à", type: "system" },
    { timestamp: "2025-09-05 09:00", text: "‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏•‡∏Ç‡πÄ‡∏Ñ‡∏™ RG-AG-0002/2025", type: "system" }
  ],
  reminders: [
    { id: "r1", title: "‡∏¢‡πâ‡∏≥‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ï‡∏±‡∏ß‡∏à‡∏£‡∏¥‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏¢‡∏∑‡πà‡∏ô", due: "2025-10-01", channel: "email", priority: "medium", active: true }
  ],
  chatMessages: [
    { id: "m1", sender: "staff", name: "‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ä‡∏≤‡∏¢", message: "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÑ‡∏´‡∏°‡∏Ñ‡∏£‡∏±‡∏ö", timestamp: "2025-09-25 09:00", avatar: "üë®‚Äçüíº" },
    { id: "m2", sender: "user", name: "‡∏Ñ‡∏∏‡∏ì‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤", message: "‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏≠‡∏¢‡∏≤‡∏Å‡∏ó‡∏£‡∏≤‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á‡∏Ñ‡∏£‡∏±‡∏ö", timestamp: "2025-09-25 09:30", avatar: "üë§" }
  ],
  lineDeeplink: "https://line.me/R/ti/p/@991cyisb"
};
function loadData(){
  try { const raw = localStorage.getItem(STORAGE_KEY); if(!raw) return structuredClone(DEFAULT_DATA);
        const parsed = JSON.parse(raw); return { ...structuredClone(DEFAULT_DATA), ...parsed }; }
  catch { return structuredClone(DEFAULT_DATA); }
}
let CASE_DATA = loadData();
const $ = (s) => document.querySelector(s);
const $$ = (s) => [...document.querySelectorAll(s)];
function showNotification(message, type='success', duration=4000){
  const container = $('#notificationContainer'); if(!container) return;
  const n = document.createElement('div'); n.className = `notification ${type}`;
  n.innerHTML = `<div style="display:flex;align-items:center;gap:12px;"><span>${type==='success'?'‚úÖ':type==='error'?'‚ùå':'‚ÑπÔ∏è'}</span><span>${message}</span></div>`;
  container.appendChild(n);
  setTimeout(()=>n.classList.add('show'),100);
  setTimeout(()=>{ n.classList.remove('show'); setTimeout(()=>container.removeChild(n),300); }, duration);
  const aria = $('#ariaLive'); if(aria) aria.textContent = message;
}
function persist(){ try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(CASE_DATA)); }catch(e){ console.warn('Persist failed', e);} }
function formatDateTime(d){ const dt = new Date(d); return isNaN(dt) ? d : dt.toLocaleString('th-TH'); }
function navActive(page){ $$('.tabs a').forEach(a => a.classList.toggle('active', a.dataset.page === page)); }
</script>
</head>
<body>
<div class="container">
<header>
  <div class="logo">RG</div>
  <div class="header-content">
    <h1>R.Good Service ‚Äî ‡∏û‡∏≠‡∏£‡πå‡∏ó‡∏±‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h1>
    <div class="header-status">
      <div class="status-dot"></div>
      <span>‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</span>
    </div>
  </div>
  <div class="header-actions">
    <div class="last-update" id="lastUpdate">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: <span id="lastUpdateText"></span></div>
    <a class="btn ghost" id="btnLine">‡∏ó‡∏±‡∏Å LINE</a>
    <a class="btn" href="profile.html">‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</a>
  </div>
</header>
<script>
  document.addEventListener('DOMContentLoaded', ()=>{
    const lu = document.getElementById('lastUpdateText');
    if(lu){ lu.textContent = new Date().toLocaleString('th-TH'); setInterval(()=>lu.textContent = new Date().toLocaleString('th-TH'), 60000); }
    const btnLine = document.getElementById('btnLine');
    if(btnLine){ btnLine.addEventListener('click', ()=>window.open(CASE_DATA.lineDeeplink, '_blank')); }
  });
</script>

<nav class="tabs">
  <a class="tab" data-page="dashboard" href="dashboard_client.html">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</a>
  <a class="tab" data-page="documents" href="documents.html">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</a>
  <a class="tab" data-page="timeline" href="timeline.html">‡πÑ‡∏ó‡∏°‡πå‡πÑ‡∏•‡∏ô‡πå</a>
  <a class="tab" data-page="reminders" href="reminders.html">‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</a>
  <a class="tab" data-page="chat" href="chat.html">‡πÅ‡∏ä‡∏ó</a>
</nav>
<script>document.addEventListener('DOMContentLoaded', ()=> navActive('dashboard'));</script>

<main>
  <div class="case-overview">
    <div class="main-case-info">
      <div class="case-header">
        <div class="case-title" id="caseTitle">‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡πÄ‡∏Ñ‡∏™: ‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏™‡∏≤‡∏£‡∏Å‡∏≥‡∏à‡∏±‡∏î‡∏ß‡∏±‡∏ä‡∏û‡∏∑‡∏ä</div>
        <!-- (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤/‡∏™‡∏≤‡∏°‡∏±‡∏ç) -->
      </div>

      <div class="case-pills">
        <div class="case-pill"><strong>‡πÄ‡∏•‡∏Ç‡πÄ‡∏Ñ‡∏™:</strong> <span id="caseNo">RG-AG-0002/2025</span></div>
        <div class="case-pill"><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</strong> <span id="caseStatus">‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠</span></div>
        <div class="case-pill"><strong>‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î:</strong> <span id="dueDate">2025-11-15</span></div>
      </div>

      <div class="product-info">
        <div class="info-tile">
          <span class="info-label">‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤</span>
          <span class="info-value" id="tradeName">RG-Herbex 48SL</span>
        </div>
        <div class="info-tile">
          <span class="info-label">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏°‡∏±‡∏ç</span>
          <span class="info-value" id="commonName">Glyphosate isopropylamine</span>
        </div>
      </div>

      <div class="progress-container">
        <div class="progress-header">
          <div class="progress-group">
            <span class="progress-label">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</span>
            <strong class="progress-percentage" id="progressPct">50%</strong>
          </div>
          <!-- (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå/‡∏ï‡∏±‡πâ‡∏á‡πÄ‡∏õ‡πá‡∏ô 100%) -->
        </div>
        <div class="progress-bar"><div class="progress-fill" id="progressFill" style="width: 50%"></div></div>
      </div>

      <div class="stepper-container">
        <div class="stepper" id="stepper">
          <div class="step completed" data-step="0">
            <div class="step-dot"></div>
            <div class="step-content">
              <div class="step-label">‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</div>
              <div class="step-date" data-step-date="">2025-09-05</div>
            </div>
          </div>
          <div class="step completed" data-step="1">
            <div class="step-dot"></div>
            <div class="step-content">
              <div class="step-label">‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</div>
              <div class="step-date" data-step-date="">2025-09-06</div>
            </div>
          </div>
          <div class="step completed" data-step="2">
            <div class="step-dot"></div>
            <div class="step-content">
              <div class="step-label">‡∏Ç‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°</div>
              <div class="step-date" data-step-date="">2025-09-08</div>
            </div>
          </div>
          <div class="step active" data-step="3">
            <div class="step-dot"></div>
            <div class="step-content">
              <div class="step-label">‡∏¢‡∏∑‡πà‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠</div>
              <div class="step-date" data-step-date="">‚Äî</div>
            </div>
          </div>
          <div class="step" data-step="4">
            <div class="step-dot"></div>
            <div class="step-content">
              <div class="step-label">‡∏£‡∏≠‡∏ú‡∏•‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏£‡∏±‡∏ê</div>
              <div class="step-date" data-step-date="">‚Äî</div>
            </div>
          </div>
          <div class="step" data-step="5">
            <div class="step-dot"></div>
            <div class="step-content">
              <div class="step-label">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß</div>
              <div class="step-date" data-step-date="">‚Äî</div>
            </div>
          </div>
          <div class="step" data-step="6">
            <div class="step-dot"></div>
            <div class="step-content">
              <div class="step-label">‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏™</div>
              <div class="step-date" data-step-date="">‚Äî</div>
            </div>
          </div>
        </div>
        <!-- (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏∏‡πà‡∏° next/back/reset) -->
      </div>

      <div class="action-buttons">
        <button class="btn primary" id="btnUpload">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>
        <!-- (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ‡∏ï‡∏±‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏Ç‡∏≠‡∏ó‡∏µ‡∏°‡∏ä‡πà‡∏ß‡∏¢ / ‡πÅ‡∏ä‡∏£‡πå‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏≠‡∏≠‡∏Å) -->
      </div>
    </div>

    <div class="doc-summary-card">
      <div class="summary-header" style="display:flex;justify-content:space-between;align-items:center;">
        <div class="summary-title">‡∏™‡∏£‡∏∏‡∏õ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</div>
        <button class="btn" id="btnNewDoc">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>
      </div>
      <div class="summary-stats" id="docSummary" style="display:flex;gap:16px;margin-top:10px;">
        <div class="summary-item">
          <div class="summary-label">‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</div>
          <div class="summary-count success" id="docApproved">1</div>
        </div>
        <div class="summary-item">
          <div class="summary-label">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à</div>
          <div class="summary-count muted" id="docPending">1</div>
        </div>
        <div class="summary-item">
          <div class="summary-label">‡πÉ‡∏Å‡∏•‡πâ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏/‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏</div>
          <div class="summary-count warning" id="docExpiring">0</div>
        </div>
      </div>
    </div>
  </div>
</main>
</div>

<!-- Upload Document Modal -->
<dialog id="modalUpload">
  <div class="modal-header">
    <div class="modal-title">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</div>
    <button class="btn ghost" onclick="this.closest('dialog').close()">‚úï</button>
  </div>
  <div class="modal-content">
    <div class="form-group">
      <label class="form-label">‡∏ä‡∏ô‡∏¥‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
      <select class="form-select" id="docType">
        <option value="id-copy">‡∏™‡∏≥‡πÄ‡∏ô‡∏≤‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</option>
        <option value="power-of-attorney">‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏°‡∏≠‡∏ö‡∏≠‡∏≥‡∏ô‡∏≤‡∏à</option>
        <option value="registration-doc">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢</option>
        <option value="company-reg">‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</option>
        <option value="tax-id">‡πÉ‡∏ö ‡∏†.‡∏û. 20</option>
      </select>
    </div>
    <div class="form-group">
      <label class="form-label">‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</label>
      <input accept=".pdf,.jpg,.jpeg,.png" class="form-input" id="docFile" type="file"/>
    </div>
    <div class="form-group">
      <label class="form-label">‡∏ß‡∏±‡∏ô‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)</label>
      <input class="form-input" id="docExpiry" type="date"/>
    </div>
    <div class="form-group">
      <label class="form-label">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
      <textarea class="form-input" id="docNote" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°..." rows="3"></textarea>
    </div>
    <div class="modal-actions">
      <button class="btn ghost" onclick="this.closest('dialog').close()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
      <button class="btn primary" id="confirmUpload">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î</button>
    </div>
  </div>
</dialog>

<div id="notificationContainer"></div>
<div aria-atomic="true" aria-live="polite" class="sr-only" id="ariaLive"></div>

<script>
/* ====== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• & ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡∏Ñ‡∏á‡∏î‡∏µ‡πÑ‡∏ã‡∏ô‡πå‡πÄ‡∏õ‡πä‡∏∞) ====== */
function renderProgress(pct){ $('#progressPct').textContent = `${pct}%`; $('#progressFill').style.width = `${pct}%`; }
function computeProgressFromSteps(){
  const total = CASE_DATA.steps.length;
  let completed = CASE_DATA.steps.filter(s=>s.state==='completed').length;
  const hasActive = CASE_DATA.steps.some(s=>s.state==='active');
  let pct = ((completed + (hasActive?0.5:0)) / total) * 100;
  return Math.min(100, Math.round(pct));
}
function hydrate(){
  $('#tradeName').textContent = CASE_DATA.product?.tradeName || '-';
  $('#commonName').textContent = CASE_DATA.product?.commonName || '-';
  $('#caseStatus').textContent = CASE_DATA.status;
  $('#caseNo').textContent = CASE_DATA.caseNo;
  $('#dueDate').textContent = CASE_DATA.dueDate;
  renderProgress(CASE_DATA.progressPct ?? computeProgressFromSteps());
  $$('#stepper .step').forEach((el,i)=>{
    const st = CASE_DATA.steps[i]?.state || 'pending';
    el.classList.remove('completed','active');
    if(st==='completed') el.classList.add('completed');
    if(st==='active') el.classList.add('active');
    const dateEl = el.querySelector('[data-step-date]');
    if(dateEl){ dateEl.textContent = CASE_DATA.steps[i]?.date || '‚Äî'; }
  });
}

function handleDocumentUpload(){
  const file = $('#docFile').files[0];
  const expiry = $('#docExpiry').value;
  const note = $('#docNote').value;
  if (!file) { showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£', 'error'); return; }
  const newDoc = { id:`d${(CASE_DATA.documents?.length||0)+1}`, type: $('#docType').selectedOptions[0].text, ref:`REF-${Math.random().toString(36).substr(2,4).toUpperCase()}`, status:'‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à', expires: expiry||'‚Äî', note: note||'‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏î‡∏¢‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤' };
  (CASE_DATA.documents ||= []).push(newDoc);
  (CASE_DATA.timeline ||= []).unshift({ timestamp: new Date().toISOString(), text:`‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î${newDoc.type}‡πÅ‡∏•‡πâ‡∏ß`, type:'user' });
  persist(); $('#modalUpload').close(); showNotification('‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
  $('#docFile').value=''; $('#docExpiry').value=''; $('#docNote').value='';
}

document.addEventListener('DOMContentLoaded', ()=>{
  hydrate();
  // ‡πÄ‡∏õ‡∏¥‡∏î modal ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î (‡∏Ñ‡∏á UX ‡πÄ‡∏î‡∏¥‡∏°)
  ['btnUpload','btnNewDoc'].forEach(id=>{
    const el = document.getElementById(id); 
    if(el) el.addEventListener('click', ()=>document.getElementById('modalUpload').showModal());
  });
  $('#confirmUpload').addEventListener('click', handleDocumentUpload);

  // **‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏î‡∏ó‡∏µ‡πà‡∏™‡πÄ‡∏ï‡πá‡∏õ (‡∏´‡πâ‡∏≤‡∏°‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏≠‡∏á)**
  document.querySelectorAll('#stepper .step').forEach((el)=>{
    el.style.cursor = 'default';
    el.addEventListener('click', (e)=> {
      e.preventDefault();
      showNotification('‡πÇ‡∏´‡∏°‡∏î‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß', 'info', 2000);
    });
  });
});
</script>
</body>
</html>
