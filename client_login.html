<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <title>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <style>
    body {
      font-family: "Prompt", "Inter", sans-serif;
      margin: 0; padding: 0;
      min-height: 100vh;
      display: flex; align-items: center; justify-content: center;
      background: linear-gradient(135deg, #06b6d4, #10b981);
    }
    .login-box {
      background: rgba(255,255,255,0.95);
      padding: 40px;
      border-radius: 16px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.25);
      max-width: 380px;
      width: 100%;
      text-align: center;
    }
    h1 {
      font-size: 22px;
      margin-bottom: 20px;
      color: #065f46;
    }
    input {
      width: 100%;
      padding: 12px;
      margin: 12px 0;
      border-radius: 10px;
      border: 1px solid #ccc;
      font-size: 16px;
      box-sizing: border-box;
    }
    button {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 10px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      background: linear-gradient(135deg, #0ea5e9, #10b981);
      color: white;
      transition: 0.2s;
    }
    button:hover {
      background: linear-gradient(135deg, #0284c7, #059669);
    }
    .msg {
      margin-top: 15px;
      font-size: 14px;
      color: #065f46;
    }
    .tab-btn {
      width: 48%;
      padding: 10px;
      margin: 0 1%;
      border: 2px solid #0ea5e9;
      border-radius: 8px;
      background: white;
      color: #0ea5e9;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: 0.2s;
    }
    .tab-btn.active {
      background: linear-gradient(135deg, #0ea5e9, #10b981);
      color: white;
      border-color: transparent;
    }
    .tab-btn:hover {
      transform: translateY(-2px);
    }
  </style>
</head>
<body>
  <div class="login-box">
    <h1>üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤</h1>
    
    <div style="margin-bottom: 20px;">
      <button class="tab-btn active" onclick="switchTab('magic')">Magic Link</button>
      <button class="tab-btn" onclick="switchTab('password')">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</button>
    </div>

    <div id="magicTab">
      <p>‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</p>
      <input type="email" id="emailMagic" placeholder="example@company.com" />
      <button onclick="loginMagic()">‡∏™‡πà‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå</button>
    </div>

    <div id="passwordTab" style="display: none;">
      <p>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</p>
      <input type="email" id="emailPassword" placeholder="example@company.com" />
      <input type="password" id="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" />
      <button onclick="loginPassword()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
    </div>

    <div class="msg" id="msg"></div>
  </div>

<script>
const SUPABASE_URL = "https://qmugpalgcktfwixqepti.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFtdWdwYWxnY2t0ZndpeHFlcHRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4NzI3NjcsImV4cCI6MjA3NDQ0ODc2N30.cIOCbJAr8_Gbg8d5IxpTQZKVRgl1ETN1hyBgL2_LveA";
const client = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

function switchTab(tab) {
  const magicTab = document.getElementById("magicTab");
  const passwordTab = document.getElementById("passwordTab");
  const tabs = document.querySelectorAll(".tab-btn");
  const msgBox = document.getElementById("msg");
  
  msgBox.textContent = "";
  
  if (tab === 'magic') {
    magicTab.style.display = "block";
    passwordTab.style.display = "none";
    tabs[0].classList.add("active");
    tabs[1].classList.remove("active");
  } else {
    magicTab.style.display = "none";
    passwordTab.style.display = "block";
    tabs[0].classList.remove("active");
    tabs[1].classList.add("active");
  }
}

async function loginMagic() {
  const email = document.getElementById("emailMagic").value.trim();
  const msgBox = document.getElementById("msg");
  
  if (!email) {
    msgBox.textContent = "‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•";
    return;
  }
  
  msgBox.textContent = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå...";
  
  const { error } = await client.auth.signInWithOtp({
    email: email,
    options: { emailRedirectTo: window.location.origin + "/client.html" }
  });
  
  if (error) {
    msgBox.textContent = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + error.message;
  } else {
    msgBox.textContent = "‚úÖ ‡∏™‡πà‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢";
  }
}

async function loginPassword() {
  const email = document.getElementById("emailPassword").value.trim();
  const password = document.getElementById("password").value;
  const msgBox = document.getElementById("msg");
  
  if (!email || !password) {
    msgBox.textContent = "‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô";
    return;
  }
  
  msgBox.textContent = "‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö...";
  
  const { data, error } = await client.auth.signInWithPassword({
    email: email,
    password: password
  });
  
  if (error) {
    msgBox.textContent = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + error.message;
  } else {
    msgBox.textContent = "‚úÖ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!";
    setTimeout(() => {
      window.location.href = "/client.html";
    }, 1000);
  }
}
</script>
</body>
</html>
