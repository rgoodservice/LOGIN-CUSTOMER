<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>summary.html ‚Äî ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)</title>

<!-- ‡πÉ‡∏ä‡πâ UMD ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠/‡∏≠‡∏¥‡∏ô‡πÅ‡∏≠‡∏õ -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Prompt:wght@400;600;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#f9fafb;
    --card:#ffffff;
    --border:#e5e7eb;
    --text:#0f172a;
    --muted:#64748b;
    --accent:#0ea5a5;
    --accent2:#60a5fa;
    --warn:#b45309;
    --danger:#b91c1c;
    --ok:#0b7a58;

    --row-warn:#fff7ed;   /* ‡πÅ‡∏ñ‡∏ß ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ */
    --row-done:#ecfdf5;   /* ‡πÅ‡∏ñ‡∏ß ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß */
    --row-stop:#fef2f2;   /* ‡πÅ‡∏ñ‡∏ß ‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß */

    --radius:14px;
  }
  *{box-sizing:border-box}
  body{
    margin:0; font-family:"Prompt",ui-sans-serif,system-ui; color:var(--text); background:var(--bg);
  }
  header{
    padding:18px;
    background:linear-gradient(135deg,#e0f7f5,#f0fdfa);
    border-bottom:1px solid var(--border);
    display:flex; align-items:center; justify-content:space-between; gap:12px;
  }
  .logo{font-weight:700; font-size:20px; color:#0b3a4f}
  main{max-width:1000px; margin:26px auto; padding:0 16px}
  .card{
    background:var(--card); border:1px solid var(--border); border-radius:var(--radius);
    padding:18px; margin-bottom:16px; box-shadow:0 6px 20px rgba(10,20,50,.06)
  }
  h2{margin:0 0 10px; font-size:20px; color:#0b3a4f}
  .mut{color:var(--muted)}
  .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
  .spacer{flex:1}

  input, select, button{
    padding:10px 12px; border-radius:12px; border:1px solid var(--border); background:#fff;
    font-size:15px; color:var(--text)
  }
  .btn{cursor:pointer; background:linear-gradient(135deg,var(--accent),var(--accent2)); color:#fff; font-weight:700; border:none}
  .btn-ghost{background:#fff; color:#0e7490; border:1px solid #94d5e5; cursor:pointer}

  .filter-bar{display:flex; gap:10px; align-items:center; margin:10px 0 0}

  table{width:100%; border-collapse:collapse; font-size:15px; background:#fff; border:1px solid var(--border); border-radius:12px; overflow:hidden}
  thead th{background:#f1f5f9; text-align:left; padding:10px}
  tbody td{padding:10px; border-top:1px solid var(--border); vertical-align:top}

  /* ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡πÅ‡∏ñ‡∏ß‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ */
  tr.row-inprog{ background: var(--row-warn); }
  tr.row-done{   background: var(--row-done); }
  tr.row-stop{   background: var(--row-stop); }

  .status{font-weight:700; padding:4px 10px; border-radius:999px; display:inline-block}
  .status[data-status="‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£"]{background:#fff7ed; color:var(--warn); border:1px solid #facc1540}
  .status[data-status="‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß"]{background:#ecfdf5; color:var(--ok); border:1px solid #34d39955}
  .status[data-status="‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß"]{background:#fef2f2; color:var(--danger); border:1px solid #fca5a555}

  /* ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏µ‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡∏≠‡πà‡∏≠‡∏ô‡πÉ‡∏´‡πâ‡πÄ‡∏î‡πà‡∏ô */
  .note-box{
    background:#e7f0ff; color:#0b3a4f; border:1px solid #bfd6ff;
    padding:10px 12px; border-radius:10px; white-space:pre-wrap;
  }

  /* ‡πÄ‡∏™‡πâ‡∏ô‡∏Ñ‡∏±‡πà‡∏ô‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏° (‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ä‡∏≠‡∏ö) */
  .section-title{
    font-weight:700; color:#0ea5a5; margin:6px 0 8px; font-size:16px
  }
  .hr{height:1px; background:#e2e8f0; margin:6px 0 10px}
</style>
</head>
<body>
<header>
  <div class="logo">üìù ‡∏™‡∏£‡∏∏‡∏õ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)</div>
  <button class="btn-ghost" onclick="history.length>1?history.back():window.close()">‡∏õ‡∏¥‡∏î</button>
</header>

<main>
  <div class="card">
    <h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</h2>
    <div id="companyName" class="mut" style="margin-bottom:8px">‚Äî</div>

    <div class="row">
      <div class="spacer"></div>
      <div id="summaryLine" class="mut"></div>
    </div>

    <div class="filter-bar">
      <label for="statusFilter">‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞:</label>
      <select id="statusFilter">
        <option value="‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
        <option value="‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£+‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£">‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß + ‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
        <option value="‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß">‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß</option>
      </select>

      <div class="spacer"></div>
      <input id="q" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: ‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤ / ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏°‡∏±‡∏ç" style="min-width:240px">
      <button id="clearBtn" class="btn-ghost">‡∏•‡πâ‡∏≤‡∏á</button>
      <button id="refreshBtn" class="btn">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
    </div>
  </div>

  <div class="card">
    <table id="noteTable">
      <thead>
        <tr>
          <th style="width:64px">‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
          <th>‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤</th>
          <th>‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏°‡∏±‡∏ç/‡∏™‡∏π‡∏ï‡∏£</th>
          <th style="width:180px">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
          <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="5" class="mut" style="padding:14px">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>
      </tbody>
    </table>
  </div>
</main>

<script>
/* ===== Supabase config ===== */
const SUPABASE_URL = "https://qmugpalgcktfwixqepti.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFtdWdwYWxnY2t0ZndpeHFlcHRpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg4NzI3NjcsImV4cCI6MjA3NDQ0ODc2N30.cIOCbJAr8_Gbg8d5IxpTQZKVRgl1ETN1hyBgL2_LveA";
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

const $ = id => document.getElementById(id);
let RAW = [];   // ‡∏î‡∏¥‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
let VIEW = [];  // ‡∏´‡∏•‡∏±‡∏á‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå/‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤

function escapeHtml(s){return String(s??'').replace(/[&<>"']/g, m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]) )}

/* ===== ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö code ‡πÄ‡∏õ‡πá‡∏ô "‡∏£‡∏´‡∏±‡∏™‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤" (RPC) ‡∏´‡∏£‡∏∑‡∏≠ "‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" (query ‡∏ï‡∏£‡∏á) ===== */
async function loadNotes(){
  const params = new URLSearchParams(location.search);
  const codeRaw = (params.get('code')||'').trim();
  const code = codeRaw.toUpperCase();

  if(!code){
    $('companyName').textContent = '‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏™‡πà‡∏á code ‡πÉ‡∏ô URL (?code=...)';
    return;
  }

  // ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÅ‡∏ö‡∏ö‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏Å‡πà‡∏≠‡∏ô (RPC)
  let rows = [];
  try{
    const nameRes = await sb.rpc('get_company_name_by_code', { p_plain_code: code });
    if(nameRes?.data){
      $('companyName').textContent = `‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó: ${nameRes.data} (‡∏£‡∏´‡∏±‡∏™‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${code})`;
      const res = await sb.rpc('get_company_portal', { p_plain_code: code });
      if(res.error){ throw res.error; }
      rows = res.data || [];
    }else{
      // fallback: ‡πÉ‡∏ä‡πâ code ‡πÄ‡∏õ‡πá‡∏ô company_code ‡∏ï‡∏£‡∏á
      $('companyName').textContent = `‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó: ${code}`;
      const res2 = await sb
        .from('product_registrations')
        .select('brand_name,common_label,renewed_status,renewed_note')
        .eq('company_code', code)
        .order('brand_name', {ascending:true});
      if(res2.error){ throw res2.error; }
      rows = res2.data || [];
    }
  }catch(err){
    document.querySelector('#noteTable tbody').innerHTML =
      `<tr><td colspan="5" style="color:#b91c1c;padding:14px">${escapeHtml(err.message||err)}</td></tr>`;
    return;
  }

  // ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ renewed_until ‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ renewed_status ‡πÉ‡∏´‡πâ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤ "‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß"
  RAW = rows.map(r => ({
    brand_name: r.brand_name || '',
    common_label: r.common_label || '',
    renewed_status: r.renewed_status || (r.renewed_until ? '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß' : null),
    renewed_note: r.renewed_note || ''
  }));

  applyFilter();
}

/* ===== ‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå + ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ===== */
function applyFilter(){
  const mode = $('statusFilter').value;
  const q = ($('q').value||'').trim().toLowerCase();

  // 1) ‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
  let pool = RAW.filter(r=>{
    const s = r.renewed_status || '';
    if(mode === '‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î') return true;
    if(mode === '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£+‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£') return (s === '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß' || s === '‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£');
    if(mode === '‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß') return (s === '‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß');
    return true;
  });

  // 2) ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
  if(q){
    pool = pool.filter(r =>
      (r.brand_name||'').toLowerCase().includes(q) ||
      (r.common_label||'').toLowerCase().includes(q)
    );
  }

  // 3) ‡πÄ‡∏£‡∏µ‡∏¢‡∏á: ‡∏Å‡∏•‡∏∏‡πà‡∏° ‚Äú‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß/‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‚Äù ‡∏°‡∏≤‡∏Å‡πà‡∏≠‡∏ô, ‡∏ï‡πà‡∏≠‡∏î‡πâ‡∏ß‡∏¢ ‚Äú‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß‚Äù
  const rank = s => (s==='‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß'||s==='‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£') ? 0 : (s==='‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß'?1:2);
  pool.sort((a,b)=>{
    const ra = rank(a.renewed_status||''), rb = rank(b.renewed_status||'');
    if(ra !== rb) return ra - rb;
    return (a.brand_name||'').localeCompare(b.brand_name||'', 'th');
  });

  VIEW = pool;
  renderTable();
  renderSummary();
}

/* ===== ‡πÄ‡∏£‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ï‡∏≤‡∏£‡∏≤‡∏á ===== */
function renderTable(){
  const tb = document.querySelector('#noteTable tbody');
  if(VIEW.length === 0){
    tb.innerHTML = `<tr><td colspan="5" class="mut" style="padding:14px">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç</td></tr>`;
    return;
  }

  tb.innerHTML = VIEW.map((r,i)=>{
    const status = r.renewed_status || '-';
    const rowCls =
      status==='‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' ? 'row-inprog' :
      status==='‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß'       ? 'row-done'   :
      status==='‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß'       ? 'row-stop'   : '';
    const noteHtml = r.renewed_note ? `<div class="note-box">${escapeHtml(r.renewed_note)}</div>` : '-';

    return `
      <tr class="${rowCls}">
        <td>${i+1}</td>
        <td>${escapeHtml(r.brand_name||'-')}</td>
        <td>${escapeHtml(r.common_label||'-')}</td>
        <td><span class="status" data-status="${escapeHtml(status)}">${escapeHtml(status)}</span></td>
        <td>${noteHtml}</td>
      </tr>
    `;
  }).join('');
}

/* ===== ‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô ===== */
function renderSummary(){
  const all = VIEW.length;
  const inprog = VIEW.filter(r=>r.renewed_status==='‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£').length;
  const done   = VIEW.filter(r=>r.renewed_status==='‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß').length;
  const stop   = VIEW.filter(r=>r.renewed_status==='‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß').length;
  $('summaryLine').textContent =
    `‡∏£‡∏ß‡∏° ${all.toLocaleString('th-TH')} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‚Ä¢ ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß ${done.toLocaleString('th-TH')} ‚Ä¢ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£ ${inprog.toLocaleString('th-TH')} ‚Ä¢ ‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≠‡∏≠‡∏≤‡∏¢‡∏∏‡πÅ‡∏•‡πâ‡∏ß ${stop.toLocaleString('th-TH')}`;
}

/* ===== Events ===== */
document.addEventListener('DOMContentLoaded', ()=>{
  loadNotes();
  $('statusFilter').addEventListener('change', applyFilter);
  $('q').addEventListener('input', applyFilter);
  $('clearBtn').addEventListener('click', ()=>{ $('q').value=''; applyFilter(); });
  $('refreshBtn').addEventListener('click', loadNotes);
});
</script>
</body>
</html>
